!function(e){var t=e("input#search"),r=e(".search-results .focused");e(document).ready(function(){window.index=lunr(function(){this.field("title",{boost:100}),this.field("tags",{boost:10}),this.field("body"),this.ref("href")}),window.index.pipeline.reset(),e.each(database,function(e,t){var r=jQuery.extend({},t);r.href="http://allanwang.ca/"+e,window.index.add(r)}),e("ul#nav-bar li.search .search-wrapper i.material-icons").click(function(){r.length?r.first()[0].click():e(".search-results").children().length&&e(".search-results").children().first()[0].click()});var s=function(t){var r=e(".search-results");r.empty(),Array.prototype.forEach.call(t,function(t){var s=e("<a href="+t[1]+">"+t[0]+"</a>");r.append(s)})},i=function(e){var t;return function(){var r=Array.prototype.slice.call(arguments),s=this;clearTimeout(t),t=setTimeout(function(){e.apply(s,r)},100)}};t.focus(function(){e(this).parent().addClass("focused"),e(".search-results").show(250)}),t.blur(function(){e(this).parent().removeClass("focused"),setTimeout(function(){e(".search-results").hide(250)},100)}),t.bind("keyup",i(function(t){if(e(this).val()<2)return void s([]);if(38!==t.which&&40!==t.which&&13!==t.keyCode){var r=e(this).val(),i=window.index.search(r).slice(0,6).map(function(e){var t=e.ref.split("http://allanwang.ca/")[1];return[database[t].title,e.ref]});s(i)}})),t.bind("keydown",i(function(t){if(27===t.keyCode)return e(this).val(""),e(this).blur(),void s([]);if(13===t.keyCode)return void(r.length?r.first()[0].click():e(".search-results").children().length&&e(".search-results").children().first()[0].click());var i;switch(t.which){case 38:r.length&&(i=r,i.removeClass("focused"),i.prev().addClass("focused"));break;case 40:r.length?(i=r,i.next().length&&(i.removeClass("focused"),i.next().addClass("focused"))):(i=e(".search-results").children().first(),i.addClass("focused"));break;default:return}t.preventDefault()}))})}(jQuery);