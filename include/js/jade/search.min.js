!function(a){var b=a("input#search"),c=a(".search-results .focused"),d="http://allanwang.ca/";a(document).ready(function(){window.index=lunr(function(){this.field("title",{boost:100}),this.field("tags",{boost:10}),this.field("body"),this.ref("href")}),window.index.pipeline.reset(),a.each(database,function(a,b){var c=jQuery.extend({},b);c.href=d+a,window.index.add(c)}),a("ul#nav-bar li.search .search-wrapper i.material-icons").click(function(){c.length?c.first()[0].click():a(".search-results").children().length&&a(".search-results").children().first()[0].click()});var e=function(b){var c=a(".search-results");if(c.empty(),b){if(0==b.length){var d=a("<a>No results found</a>");return void c.append(d)}Array.prototype.forEach.call(b,function(b){var d=a("<a href="+b[1]+">"+b[0]+"</a>");c.append(d)})}},f=function(a){var b;return function(){var c=Array.prototype.slice.call(arguments),d=this;clearTimeout(b),b=setTimeout(function(){a.apply(d,c)},100)}};b.focus(function(){a(this).parent().addClass("focused"),a(".search-results").show(250)}),b.blur(function(){a(this).parent().removeClass("focused"),setTimeout(function(){a(".search-results").hide(250)},100)}),b.bind("keyup",f(function(b){if(a(this).val()<2)return void e(null);if(38!==b.which&&40!==b.which&&13!==b.keyCode){var c=a(this).val();if(!c)return e(null);var f=window.index.search(c).slice(0,6).map(function(a){var b=a.ref.slice(d.length);return[database[b].title,a.ref]});e(f)}})),b.bind("keydown",f(function(b){if(27===b.keyCode)return a(this).val(""),a(this).blur(),void e(null);if(13===b.keyCode)return void(c.length?c.first()[0].click():a(".search-results").children().length&&a(".search-results").children().first()[0].click());var d;switch(b.which){case 38:c.length&&(d=c,d.removeClass("focused"),d.prev().addClass("focused"));break;case 40:c.length?(d=c,d.next().length&&(d.removeClass("focused"),d.next().addClass("focused"))):(d=a(".search-results").children().first(),d.addClass("focused"));break;default:return}b.preventDefault()}))})}(jQuery);