!function(e){var r=e("input#search"),t=e(".search-results .focused");e(document).ready(function(){window.index=lunr(function(){this.field("title",{boost:100}),this.field("tags",{boost:10}),this.field("body"),this.ref("href")}),window.index.pipeline.reset(),e.each(database,function(e,r){var t=jQuery.extend({},r);t.href="http://allanwang.ca/"+e,window.index.add(t)}),e("ul#nav-bar li.search .search-wrapper i.material-icons").click(function(){t.length?t.first()[0].click():e(".search-results").children().length&&e(".search-results").children().first()[0].click()});var s=function(r){var t=e(".search-results");if(t.empty(),r){if(0==r.length){var s=e("<a>No results found</a>");return void t.append(s)}Array.prototype.forEach.call(r,function(r){var s=e("<a href="+r[1]+">"+r[0]+"</a>");t.append(s)})}},n=function(e){var r;return function(){var t=Array.prototype.slice.call(arguments),s=this;clearTimeout(r),r=setTimeout(function(){e.apply(s,t)},100)}};r.focus(function(){e(this).parent().addClass("focused"),e(".search-results").show(250)}),r.blur(function(){e(this).parent().removeClass("focused"),setTimeout(function(){e(".search-results").hide(250)},100)}),r.bind("keyup",n(function(r){if(e(this).val()<2)return void s(null);if(38!==r.which&&40!==r.which&&13!==r.keyCode){var t=e(this).val();if(!t)return s(null);var n=window.index.search(t).slice(0,6).map(function(e){var r=e.ref.split("http://allanwang.ca/")[1];return[database[r].title,e.ref]});s(n)}})),r.bind("keydown",n(function(r){if(27===r.keyCode)return e(this).val(""),e(this).blur(),void s(null);if(13===r.keyCode)return void(t.length?t.first()[0].click():e(".search-results").children().length&&e(".search-results").children().first()[0].click());var n;switch(r.which){case 38:t.length&&(n=t,n.removeClass("focused"),n.prev().addClass("focused"));break;case 40:t.length?(n=t,n.next().length&&(n.removeClass("focused"),n.next().addClass("focused"))):(n=e(".search-results").children().first(),n.addClass("focused"));break;default:return}r.preventDefault()}))})}(jQuery);